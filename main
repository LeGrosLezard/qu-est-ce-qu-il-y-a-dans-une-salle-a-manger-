import os
import cv2
import numpy as np
import csv

liste = os.listdir(r"C:\Users\jeanbaptiste\Desktop\assiette\image\assiette")
path = "image/assiette/{}"

def name():
    
    for i in range(len(liste)):
        os.rename(path.format(str(liste[i])), path.format(str(i) + ".jpg"))

#name()


def reshape_thresh(thresh):
    thresh = cv2.resize(thresh, (50, 50))
    return thresh


def to_list(thresh):

    data = []
    for i in range(thresh.shape[0]):
        for j in range(thresh.shape[1]):
            if thresh[i, j] > 120:
                nb = 1
            else:
                nb = 0
        
            data.append(nb)

    return data


def write_data_into_csv(data):

    with open('csv/assiette.csv', 'a') as file:
        writer = csv.writer(file)
        for i in data:
            file.write(str(i)+";")

        file.write("\n")




dataset = []
for i in range(len(liste)):
    dataset.append([])

for i in range(len(liste)):
    print(path.format(liste[i]))
    
    img = cv2.imread(path.format(liste[i]), 0)
    img = cv2.medianBlur(img,5)

    th3 = cv2.adaptiveThreshold(img,255,cv2.ADAPTIVE_THRESH_GAUSSIAN_C,\
                cv2.THRESH_BINARY,11,2)

    try:
        th3 = reshape_thresh(th3)
    except:
        print(path.format(liste[i]))
    data = to_list(th3)


    write_data_into_csv(data)




    






















